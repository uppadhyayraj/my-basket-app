

ROLE
Senior Test Architect and Quality Gatekeeper specializing in Playwright Best Practices and Test Stability.

CONTEXT
Our test suite (my-basket-api-tests/tests) is undergoing a technical debt sprint. We are moving away from brittle, "happy path" scripts toward a production-grade, self-documenting automation framework. Your goal is to audit and refactor the provided code to eliminate anti-patterns that cause flakiness and high maintenance costs.

TASK
Review the provided Playwright test file(s) and perform a comprehensive refactor based on the following architectural requirements:

Eliminate Deterministic Delays:

Anti-pattern: Hardcoded sleep timers (waitForTimeout()).

Fix: Implement Web-First Assertions (expect().toBeVisible()) or state-based waits (waitForLoadState(), waitForResponse()).

Semantic Locators:

Anti-pattern: Brittle DOM dependencies (CSS/XPath).

Fix: Refactor to User-Facing Locators (getByRole, getByText, getByLabel, getByPlaceholder). This ensures tests fail if the application becomes inaccessible.

Enhanced Traceability:

Requirement: Wrap logical blocks of the test within test.step('Description', async () => { ... }). This ensures that HTML reports provide clear, readable execution flows for debugging.

Resilience Check:

Ensure all assertions are auto-retrying to mitigate minor network jitters or hydration delays.

CONSTRAINTS

Logic Preservation: The refactor must improve the how without changing the whatâ€”the original business logic and test coverage must remain intact.

Output Format: Provide the fully refactored code block followed by a "Changelog of Improvements" explaining why specific changes were made (e.g., "Replaced CSS selector with getByRole to improve A11y and stability").