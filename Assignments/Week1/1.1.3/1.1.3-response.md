# Cart Service Health Check Lifecycle

## Entry Point

The health check is defined as an HTTP endpoint in `microservices/cart-service/src/routes.ts`:

```ts
router.get('/health', (req: Request, res: Response) => {
  res.json({ status: 'healthy', service: 'cart-service', timestamp: new Date().toISOString() });
});
```

**Route:** `GET /api/health`  
**Port:** 3002 (Cart Service)

---

## Logic Chain

The health check is **extremely simple** — it's a synchronous response with no validation logic:

1. **No service class involved** — The route handler directly responds without calling any checker or service validation method
2. **No dependencies checked** — It doesn't validate cart data, database connections, or external services
3. **Static response** — Always returns `{ status: 'healthy', service: 'cart-service', timestamp: ... }`

---

## Dependencies

**None actively checked.** The endpoint does **not**:
- ✗ Verify the in-memory cart storage (Map in `CartService`)
- ✗ Check the Product Service connection
- ✗ Validate any external resources
- ✗ Perform database operations

---

## Trigger

**Active HTTP endpoint** — This is a passive health check triggered on-demand:

1. **Direct requests:** `curl http://localhost:3002/api/health`
2. **API Gateway aggregation:** The `HealthCheckService` in the API Gateway polls this endpoint every time `/health` is called on the gateway (port 3000)

**No background heartbeat** — It's purely request-driven.

---

## Complete Flow Summary

```
User/Gateway Request
       ↓
GET http://localhost:3002/api/health
       ↓
[microservices/cart-service/src/routes.ts] - router.get('/health')
       ↓
Immediate JSON response (no logic)
       ↓
{ status: 'healthy', service: 'cart-service', timestamp: 'ISO-8601' }
```

### Related Files

| File | Purpose |
|------|---------|
| `microservices/cart-service/src/routes.ts` | Health endpoint definition |
| `microservices/cart-service/src/index.ts` | Service startup (logs health check URL) |
| `microservices/api-gateway/src/health.ts` | Aggregates health checks from all services |
| `microservices/api-gateway/src/config.ts` | Defines `/api/health` as the health check path |

---

## Key Insight

The Cart Service health check is a **shallow, always-healthy endpoint** with no actual validation. For production, consider enhancing it to check the in-memory cart storage viability or external dependencies like the Product Service.
